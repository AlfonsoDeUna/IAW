# PRÁCTICA: CONEXIÓN PYTHON Y POWERSHELL EN NODEJS

### enviar.py

```python

import requests
import cv2

class webcam():
    
	@staticmethod
	def getPhoto():    
		cap = cv2.VideoCapture(0)

		leido, frame = cap.read()

		if leido == True:
			cv2.imwrite("foto.png", frame)
			print("Foto tomada correctamente")
		else:
			print("Error al acceder a la cámara")

		"""
			Finalmente liberamos o soltamos la cámara
		"""
		cap.release()
  

url = "http://127.0.0.1:3000/foto"
webcam.getPhoto()
files ={'image':open('foto.png','rb')}
#requests.post(url,files=files)

```

#### Instaslar la librería opencv desde consola
```python

pip install opencv-python

```

### SERVIDOR NODEJS 

```javascript

const express = require('express');
const bodyParser = require('body-parser');
var multer = require('multer');

const app = express();
const puerto = 3000;  
app.use(bodyParser.urlencoded({ extended: true }));
app.use(bodyParser.json());


var upload = multer({dest: './uploads/'});

app.post('/foto', upload.single('image'), function(request, respond) {
    console.log ("envío de fichero")
    if(request.file) console.log(request.file);
});

app.post('/receptor', (req, res) => {
    // Extraer información del cuerpo de la solicitud
    console.log (req.body)
    const parametros = req.query;
    console.log('Parámetros recibidos:', req.body.parametro1);
   
    // Puedes hacer más cosas con la información aquí, según tus necesidades
    //res.send(JSON.stringify(body, null, 2));
    res.send('Información recibida correctamente.');
});

app.listen(puerto, () => {
    console.log(`Servidor Node.js escuchando en el puerto ${puerto}`);
});

```
### POWERSHELL

````bash
# cmdlet
$message2 = Test-NetConnection
Write-Host ($message2.ComputerName)

$parametros = @{
    parametro1 = $message2.ComputerName
}

# Convertir el objeto JSON a una cadena JSON
$jsonParametros = $parametros | ConvertTo-Json
    # Enviar el mensaje al servidor Node.js
    Invoke-RestMethod -Uri "http://127.0.0.1:3000/receptor" -Method Post -Body $jsonParametros -ContentType "application/json"

```
